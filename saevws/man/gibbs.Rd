% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/gibbs.R
\name{gibbs}
\alias{gibbs}
\title{Gibbs Sampler}
\usage{
gibbs(
  y,
  s2,
  X,
  Z,
  df,
  init = get_init(m = length(y), d1 = ncol(X), d2 = ncol(Z)),
  control = get_gibbs_control(),
  fixed = get_fixed()
)
}
\arguments{
\item{y}{Observed point estimates.}

\item{s2}{Observed variance estimates.}

\item{X}{Design matrix for regression on point estimates.}

\item{Z}{Design matrix for regression on variance estimates.}

\item{df}{Degrees of freedom to use for variance estimates.}

\item{init}{Initial values from \link{get_init}.}

\item{control}{Control object from \link{get_gibbs_control}.}

\item{fixed}{Fixed value indicators from \link{get_fixed}.}
}
\value{
A list with results from the sampler.
}
\description{
Run the Gibbs sampler.
}
\examples{
\dontrun{
# Simulate data
set.seed(1234)

m = 500
tau_true = sqrt(0.25)
phi_true = sqrt(0.2)
beta_true = c(1.5, 0.85)
gamma_true = c(2.6, -1)
df = rchisq(m, 16)
X = cbind(1, rnorm(m, 8, 2))
Z = cbind(1, rnorm(m, 7, 1.25))

sigma2_true = rlnorm(m, Z \%*\% gamma_true, tau_true)
theta_true = rnorm(m, X \%*\% beta_true, phi_true)
s2 = sigma2_true / df * rchisq(m, df)
y = rnorm(m, theta_true, sqrt(s2))

ctrl = get_gibbs_control(R = 100, report = 20)
gibbs_out = gibbs(y, s2, X, Z, df, control = ctrl)
}

}
